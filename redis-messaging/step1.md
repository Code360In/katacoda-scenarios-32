
Start a Redis server in docker and run in background.

`docker run --name redis -d -p 6379:6379 redis redis-server`{{execute}}

Install python modules with pip.

`pip install redis`{{execute}}

Execute redis-cli to and connect to Redis

`docker exec -it redis redis-cli`{{execute T4}}


Open two more terminals T2, T3 and T4. 

Define the sender script `queue_sender.py` as follows.

<pre class="file" data-filename="queue_sender.py" data-target="replace">
import redis
import time

r = redis.Redis(host='localhost', port=6379)
r.set('test', 'It is working!!!')

for i in range(1000):
    print(f"Generate order {i}")
    r.rpush('queue1',f"order {i}")
    time.sleep(1)
</pre>

Define the receiver script `queue_receiver.py` as follows.

<pre class="file" data-filename="queue_receiver.py" data-target="replace">
import redis
import time

r = redis.Redis(host='localhost', port=6379)
r.set('test', 'It is working!!!')

while True:
    result = r.lpop('queue1')
    print(result)
    if result is not None:
        s = result.decode("utf-8") 
        print(f"Processing: {s}")
        time.sleep(1)
        print("Done!")
    else:
        break
</pre>


We will now launch a sender and two receivers.

First, start the sender in Terminal 2.

`python3 queue_sender.py`{{execute T2}}

Start receiver 1 in T3.

`python3 queue_receiver.py`{{execute T3}}

Start receiver 2 in T4.

`python3 queue_receiver.py`{{execute T4}}

Observe how the orders generated by the sender are processed by the two receivers.


Meanwhile, you may examine the message queue in redis-cli in T1.

`keys *`{{execute T1}}

`lrange queue1 0 -1`{{execute T1}}


Stop the sender/receiver scripts with Ctrl+C (or Ctrl+Break).

