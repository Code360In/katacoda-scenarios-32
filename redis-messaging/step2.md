

Define the publisher script for a Publish-Subscribe channel.

<pre class="file" data-filename="pubsub_publisher.py" data-target="replace">
import redis
import time

r = redis.Redis(host='localhost', port=6379)
r.set('test', 'It is working!!!')

for i in range(1000):
    print(f"Generate order {i}")
    r.publish('channel1',f"order {i}")
    time.sleep(1)

</pre>

Define the processor script for a Publish-Subscribe channel.

<pre class="file" data-filename="pubsub_processor.py" data-target="replace">
import redis
import time

r = redis.Redis(host='localhost', port=6379)
r.set('test', 'It is working!!!')

pubsub=r.pubsub()
pubsub.subscribe(['channel1'])

for item in pubsub.listen():
    print(item)
    
    if item['type']=='message':
        data =item['data'].decode("utf-8") 
        print(f"processing: {data}")
        time.sleep(3)
        print(f"done: {data}")
  
</pre>


We will now launch a publisher and two processors.



Start processor 1 in T2.

`python3 pubsub_processor.py`{{execute T2}}

Start processor 2 in T3.

`python3 pubsub_processor.py`{{execute T3}}


Next, start the publisher in Terminal 1.

`python3 queue_publisher.py`{{execute T1}}


`python3 pubsub_publisher.py`{{execute}}


Observe how the orders generated by the publisher are processed by the two processors.



Meanwhile, you may examine the channels and number of subscribers in the `queue1` channel in T1.

`PUBSUB CHANNELS`{{execute T1}}

`PUBSUB NUMSUB queue1`{{execute T1}}


> **Question:**:
>
> What is the difference between a messaging queue and publish-subscribe channel?
>

Stop the publisher/processor scripts with Ctrl+C (or Ctrl+Break).

