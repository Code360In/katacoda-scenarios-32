

Define the sender script `pubsub_sender.py` as follows.

<pre class="file" data-filename="pubsub_sender.py" data-target="replace">
import redis
import time

r = redis.Redis(host='localhost', port=6379)
r.set('test', 'It is working!!!')

for i in range(500):
    print(f"Generate: Order {i}")
    r.publish('channel1',f"Order {i}")
    time.sleep(1)

</pre>

Define the receiver script `pubsub_receiver.py` as follows.

<pre class="file" data-filename="pubsub_receiver.py" data-target="replace">
import redis
import time

r = redis.Redis(host='localhost', port=6379)
r.set('test', 'It is working!!!')

pubsub=r.pubsub()
pubsub.subscribe(['channel1'])

for item in pubsub.listen():
    print(item)
    
    if item['type']=='message':
        data =item['data'].decode("utf-8") 
        print(f"processing: {data}")
        time.sleep(2)
        print(f"done: {data}")
  
</pre>


We will now launch a sender and two receivers.


Start receiver 1 in T3.

`python3 pubsub_receiver.py`{{execute T3}}

Start receiver 2 in T4.

`python3 pubsub_receiver.py`{{execute T4}}


Next, start the sender in Terminal 2.

`python3 pubsub_sender.py`{{execute T2}}




Observe how the orders generated by the sender are processed by the two receivers.



Meanwhile, you may examine the channels and number of subscribers in the `queue1` channel in T1.

`PUBSUB CHANNELS`{{execute T1}}

`PUBSUB NUMSUB channel1`{{execute T1}}


> **Question:**:
>
> What is the difference between a messaging queue and publish-subscribe channel?
>

Stop the sender/receiver scripts with Ctrl+C (or Ctrl+Break).

